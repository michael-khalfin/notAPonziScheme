class(mkt_ret)
View(sec_1_returns)
matrix(sec_1_returns)
sec_1_returns = matrix(sec_1_returns)
mkt_ret
mkt_returns
mkt_returns = matrix(mkt_returns)
View(mkt_returns)
sec_1_reg_data = merge(sec_1_returns, mkt_returns)
sec_1_reg_data = tibble(x=mkt_returns, y=sec_1_returns)
View(sec_1_reg_data)
mkt_returns = matrix(mkt_ret_in$`Total Market`)
sec_1_regression = lm(y ~ x, data=sec_1_reg_data)
View(sec_1_reg_data)
sec_1_returns = matrix(sec_ret[1, 2:61])
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(y ~ x, data=sec_1_reg_data)
sec_i_regression = lm(market[,1] ~ security[,1], data=sec_i_reg_data)
sec_1_regression = lm(market[,1] ~ security[,1], data=sec_1_reg_data)
mkt_returns = matrix(mkt_ret_in$`Total Market`)
sec_1_returns = matrix(sec_ret[1, 2:61])
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
library(dplyer)
library(dtplyer)
library(dplyr)
rename(sec_1_reg_data, market[,1]=market)
names(sec_1_reg_data)
sec_1_regression = lm(market ~ security, data=sec_1_reg_data)
sec_1_returns = c(matrix(sec_ret[1, 2:61]))
mkt_returns = c(matrix(mkt_ret_in$`Total Market`))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(market ~ security, data=sec_1_reg_data)
View(sec_1_returns)
View(sec_1_reg_data)
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(market ~ security, data=sec_1_reg_data)
class(sec_1_reg_data$security)
sec_1_reg_data = tibble(market=mkt_returns, security=unlist(sec_1_returns)
sec_1_regression = lm(market ~ security, data=sec_1_reg_data)
sec_1_returns = unlist(matrix(sec_ret[1, 2:61]))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(market ~ security, data=sec_1_reg_data)
summary(sec_1_regression)
class(matrix(mkt_ret_in$`Total Market`))
class(c(matrix(mkt_ret_in$`Total Market`)))
class(unlist(matrix(sec_ret[1,2:61])))
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret_in = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret_in$`Total Market`))
mkt_returns = c(matrix(mkt_ret$`Total Market`))
for(i in range(num_securities)){
sec_i_returns = matrix(sec_ret[i, 2:61])
sec_i_reg_data = tibble(x=mkt_returns, y=sec_i_returns)
sec_i_regression = lm(y ~ x, data=sec_i_reg_data)
append(linear_models, sec_i_regression)
}
sec_1_returns = unlist(matrix(sec_ret[1, 2:61]))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(security ~ market, data=sec_1_reg_data)
summary(sec_1_regression)
View(sec_1_regression)
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
linear_models = c()
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
}
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
append(linear_models, sec_i_regression)
}
linear_models =
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
append(linear_models, summary(sec_i_regression))
}
linear_models = c()
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
append(linear_models, summary(sec_i_regression))
}
linear_models = list()
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
append(linear_models, summary(sec_i_regression))
}
View(linear_models)
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum = summary(sec_i_regression)
print(reg_sum)
}
View(reg_sum)
sec_1_returns = unlist(matrix(sec_ret[1, 2:61]))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(security ~ market, data=sec_1_reg_data)
summary(sec_1_regression)
reg_sum = summary(sec_1_regression)
View(reg_sum)
print(reg_sum[4])
print(reg_sum[4][2])
print(reg_sum[4])
class(reg_sum[4])
class(reg_sum[4][1])
print(reg_sum[4][1])
print(reg_sum[4][2])
print(reg_sum[4][1])
print(reg_sum[4][1][1])
print(reg_sum[4]['market'])
print(reg_sum[4])
View(reg_sum)
confint(sec_1_regression)
print(reg_sum$coefficients)
print(reg_sum$coefficients[, 1])
a_1 = reg_sum$coefficients[1, 1]
b_1 = reg_sum$coefficients[2,1]
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
alphas = c()
betas = c()
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
append(alphas, a_i)
append(betas, b_i)
}
sec_1_returns = unlist(matrix(sec_ret[1, 2:61]))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(security ~ market, data=sec_1_reg_data)
reg_sum = summary(sec_1_regression)
a_1 = reg_sum$coefficients[1, 1]
b_1 = reg_sum$coefficients[2,1]
a_1
class(a_1)
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
print(b_i)
append(alphas, a_i)
append(betas, b_i)
}
print(num_securities)
reg_sum = summary(sec_1_regression)
reg_sum
reg_sum$coefficients
reg_sum$coefficients[1, 1]
reg_sum$coefficients[2,1]
for(i in range(2)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
print(b_i)
append(alphas, a_i)
append(betas, b_i)
}
print(range(num_securities))
range(num_securities)
print(sec_i_returns)
rm(list=ls())
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
alphas = c()
betas = c()
append(alphas, 1)
alphas = append(alphas, 1)
for(i in range(num_securities)){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
print(sec_i_returns)
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
alphas = append(alphas, a_i)
betas = append(betas, b_i)
}
print(i)
for(i in range(num_securities)){
print(i)
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
alphas = append(alphas, a_i)
betas = append(betas, b_i)
}
for(i in range(1:num_securities)){
print(i)
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
alphas = append(alphas, a_i)
betas = append(betas, b_i)
}
for(i in 1:num_securities){
print(i)
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
alphas = append(alphas, a_i)
betas = append(betas, b_i)
}
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
alphas = c()
betas = c()
for(i in 1:num_securities){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
alphas = append(alphas, a_i)
betas = append(betas, b_i)
}
rm(a_i, b_i)
rm(sec_i_reg_data, sec_i_regression, reg_sum_i, i)
rm(sec_i_reg_data, sec_i_regression, reg_sum_i, i, sec_i_returns)
rm(a_i, b_i)
rm(sec_i_reg_data, sec_i_regression, reg_sum_i, i)
rm(sec_i_returns)
sec_1_returns = unlist(matrix(sec_ret[1, 2:61]))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
rm(list=ls())
library(ggplot2)
library(tibble)
library(dplyr)
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
#
sec_1_returns = unlist(matrix(sec_ret[1, 2:61]))
sec_1_reg_data = tibble(market=mkt_returns, security=sec_1_returns)
sec_1_regression = lm(security ~ market, data=sec_1_reg_data)
reg_sum = summary(sec_1_regression)
reg_sum
reg_sum$coefficients
reg_sum$coefficients[2,1]
reg_sum$coefficients[1,2]
var(mkt_returns)
summary(mkt_returns)
var(mkt_returns)
reg_sum
epsilon_1 = reg_sum$sigma
reg_sum
epsilon_1
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
mkt_ret = read_csv("market_return.csv")
mkt_ret = mkt_ret[1:60,]
sec_ret = read_csv("market_returns.csv")
sec_cap = read_csv("capitalizations.csv")
num_securities = dim(sec_ret)[1] - 1
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
var(mkt_returns)
alphas = c()
betas = c()
resid_errors = c()
for(i in 1:num_securities){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
sigma_i = reg_sum_i$sigma
alphas = append(alphas, a_i)
betas = append(betas, b_i)
resid_errors = append(resid_errors, sigma_i)
}
rm(a_i, b_i)
rm(sec_i_reg_data, sec_i_regression, reg_sum_i, i)
rm(sec_i_returns)
rm(a_i, b_i, sigma_i)
resid_errors
View(mkt_ret)
View(sec_ret)
View(sec_cap)
num_securities
num_securities = dim(sec_ret)[1]
num_periods = dim(sec_ret)[2]
mkt_returns = c(matrix(mkt_ret$`Total Market`))
var(mkt_returns)
alphas = c()
betas = c()
resid_errors = c()
num_securities
for(i in 1:num_securities){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)
reg_sum_i = summary(sec_i_regression)
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
sigma_i = reg_sum_i$sigma
alphas = append(alphas, a_i)
betas = append(betas, b_i)
resid_errors = append(resid_errors, sigma_i)
}
rm(a_i, b_i, sigma_i)
rm(sec_i_reg_data, sec_i_regression, reg_sum_i, i)
rm(sec_i_returns)
covariance_matrix = matrix(, nrow=num_securities, ncol=num_securities)
View(covariance_matrix)
covariance_matrix = matrix(NA, nrow=num_securities, ncol=num_securities)
View(covariance_matrix)
for(i in 1:num_securities){
D_matrix[i,i] = resid_errors[i]
}
D_matrix = matrix(NA, nrow=num_securities, ncol=num_securities)
for(i in 1:num_securities){
D_matrix[i,i] = resid_errors[i]
}
View(D_matrix)
b_t = t(betas)
View(b_t)
vb_t = var(mkt_returns)*b_t
View(vb_t)
cov_matrix = vb_t %*% b_t
betas_T = t(betas)
rm(vb_t)
rm(b_t)
View(betas_T)
class(betas_T)
rm(betas_T)
cov_matrix_1 = matrix(betas) %*% t(matrix(betas))
View(cov_matrix_1)
rm(cov_matrix_1)
covariance_matrix = matrix(betas) %*% t(matrix(betas))
sigma_m_2 = var(mkt_returns)
covariance_matrix = sigma_m_2 * covariance_matrix
View(covariance_matrix)
covariance_matrix = covariance_matrix + D_matrix
D_matrix = matrix(0, nrow=num_securities, ncol=num_securities)
for(i in 1:num_securities){
D_matrix[i,i] = resid_errors[i]
}
sigma_m_2 = var(mkt_returns)
covariance_matrix = matrix(betas) %*% t(matrix(betas))
covariance_matrix = sigma_m_2 * covariance_matrix
covariance_matrix = covariance_matrix + D_matrix
View(D_matrix)
E_r_m = mean(mkt_returns)
expected_returns = (betas*E_r_m) + alphas
expected_returns
rm(i)
rm(num_periods)
write.table(covariance_matrix, file="covariance_matrix.csv", row.names = 1:47, col.names = 1:47)
write.table(covariance_matrix, file="covariance_matrix.csv", row.names = F, col.names = F)
write.table(covariance_matrix, file="covariance_matrix.txt")
write.table(covariance_matrix, file="covariance_matrix.txt", row.names = FALSE)
write.table(covariance_matrix, file="covariance_matrix.txt", row.names = FALSE, col.names = FALSE)
reticulate::repl_python()
rm(list=ls())
rm(list=ls())
library(readr)
library(ggplot2)
library(tibble)
library(dplyr)
# Read in the cleaned market returns csv file
mkt_ret = read_csv("market_return.csv")
View(mkt_ret)
# Get soley the first 60 periods-- note that we removed all entries before
# 2017, so here we just need to make sure we dont get any 2022, 2023 entries
mkt_ret = mkt_ret[1:60,]
# Now, read in the data on the securities
sec_ret = read_csv("market_returns.csv")  # We are conscerned primarily with these
sec_cap = read_csv("capitalizations.csv")
# Get the number of securities in the csv- good to do it this way in case we adjust the process of producing it
num_securities = dim(sec_ret)[1]
# Here we grab (and make numeric) just the total market returns
mkt_returns = c(matrix(mkt_ret$`Total Market`))
# Data Structures for Storing Estimates
alphas = c()
betas = c()
resid_errors = c()
for(i in 1:num_securities){
sec_i_returns = unlist(matrix(sec_ret[i, 2:61]))
sec_i_reg_data = tibble(market=mkt_returns, security=sec_i_returns)
sec_i_regression = lm(security ~ market, data=sec_i_reg_data)  # Runs the regression
reg_sum_i = summary(sec_i_regression)  # Gets regression estimates
a_i = reg_sum_i$coefficients[1,1]
b_i = reg_sum_i$coefficients[1,1]
sigma_i = reg_sum_i$sigma
alphas = append(alphas, a_i)
betas = append(betas, b_i)
resid_errors = append(resid_errors, sigma_i)
}
summary(reg_sum_i)
reg_sum_i
rm(a_i, b_i, sigma_i)
rm(sec_i_reg_data, sec_i_regression, reg_sum_i, i)
rm(sec_i_returns)
# Initialize the diagonal matrix
D_matrix = matrix(0, nrow=num_securities, ncol=num_securities)
View(D_matrix)
for(i in 1:num_securities){
D_matrix[i,i] = resid_errors[i] ^ 2
}
# Clean up workspace
rm(i)
# Get the market returns variance estimate
sigma_m_2 = var(mkt_returns)
# Build the covariance matrix
covariance_matrix = matrix(betas) %*% t(matrix(betas))
covariance_matrix = sigma_m_2 * covariance_matrix
covariance_matrix = covariance_matrix + D_matrix
View(covariance_matrix)
# Build the expected returns vector
E_r_m = mean(mkt_returns)
expected_returns = (betas*E_r_m) + alphas
expected_returns
View(sec_ret)
write.table(sec_ret$names, file="names.txt",m row.names =  FALSE, col.names = FALSE)
write.table(sec_ret$names, file="names.txt", row.names =  FALSE, col.names = FALSE)
